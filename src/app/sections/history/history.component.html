<div class="space-y-8 animate-in fade-in duration-700">

  <div class="flex items-center justify-between border-b border-gray-100 pb-6">
    <div class="space-y-1">
      <h2 class="text-3xl font-bold text-gray-900 tracking-tight">Activity <span class="font-light italic">Logs</span></h2>
      <p class="text-[10px] text-gray-400 uppercase tracking-[0.3em] font-bold italic">Backup History & Audit</p>
    </div>

    <button (click)="loadHistory()"
            class="group flex items-center gap-2 px-4 py-2 bg-gray-50 hover:bg-gray-900 hover:text-white border border-gray-100 rounded-xl transition-all active:scale-95">
      <lucide-icon [name]="historyIcon" class="w-3.5 h-3.5 group-hover:rotate-180 transition-transform duration-500"></lucide-icon>
      <span class="text-[10px] font-bold uppercase tracking-widest">Refresh list</span>
    </button>
  </div>

  <div class="bg-white/40 backdrop-blur-md border border-gray-100 rounded-[2rem] shadow-sm overflow-hidden transition-all hover:shadow-md">
    <table class="w-full text-left border-collapse">
      <thead>
      <tr class="border-b border-gray-50">
        <th class="px-8 py-5 text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em]">Execution Date</th>
        <th class="px-8 py-5 text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em]">Status</th>
        <th class="px-8 py-5 text-[10px] font-bold text-gray-400 uppercase tracking-[0.2em]">Source Path</th>
        <th class="px-8 py-5 text-[100px] font-bold text-gray-400 uppercase tracking-[0.2em]">Metrics</th>
      </tr>
      </thead>

      <tbody class="divide-y divide-gray-50">
        @if (isLoading()) {
          <tr>
            <td colspan="4" class="px-8 py-16 text-center">
              <div class="flex flex-col items-center gap-3">
                <div class="animate-spin rounded-full h-5 w-5 border-2 border-gray-900 border-t-transparent"></div>
                <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">Accessing records...</span>
              </div>
            </td>
          </tr>
        } @else if (historyRecords().length === 0) {
          <tr>
            <td colspan="4" class="px-8 py-16 text-center">
              <p class="text-xs text-gray-400 italic">No backup records detected in the vault.</p>
            </td>
          </tr>
        } @else {
          @for (record of historyRecords(); track $index) {
            <tr class="hover:bg-gray-50/50 transition-colors group">
              <td class="px-8 py-5 whitespace-nowrap">
                <div class="flex flex-col">
                  <span class="text-xs font-bold text-gray-900">
                    {{ record.startedAt | date:'dd MMM, yyyy' }}
                  </span>
                  <span class="text-[10px] text-gray-400 font-mono">
                    {{ record.startedAt | date:'HH:mm:ss' }}
                  </span>
                </div>
              </td>

              <td class="px-8 py-5">
                @if (record.status === 'EM_ANDAMENTO' || record.status === 'CONCLUIDO') {
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-[9px] font-bold uppercase tracking-tighter bg-emerald-50 text-emerald-600 border border-emerald-100/50">
                    {{ record.status }}
                  </span>
                } @else {
                  <span class="inline-flex items-center px-3 py-1 rounded-full text-[9px] font-bold uppercase tracking-tighter bg-red-50 text-red-600 border border-red-100/50">
                    {{ record.status }}
                  </span>
                }
              </td>

              <td class="px-8 py-5">
                <div class="flex flex-col max-w-xs">
                  <span class="text-[11px] text-gray-600 truncate font-mono" [title]="record.sourcePath">
                    {{ record.sourcePath }}
                  </span>
                  <lucide-icon [name]="arrowIcon" class="w-3 h-3 my-1 text-gray-300"></lucide-icon>
                  <span class="text-[11px] text-gray-400 truncate font-mono" [title]="record.destinationPath">
                    {{ record.destinationPath }}
                  </span>
                </div>
              </td>

              <td class="px-8 py-5 whitespace-nowrap">
                <div class="flex flex-col gap-1">
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] font-bold text-gray-900">{{ record.totalSizeMB | number:'1.1-2' }} MB</span>
                    <span class="text-[8px] text-gray-300 uppercase">Size</span>
                  </div>
                  <div class="flex items-center gap-2">
                    <span class="text-[10px] font-medium text-gray-500">{{ record.fileCount }} files</span>
                    <span class="text-[8px] text-gray-300 uppercase">Count</span>
                  </div>
                </div>
              </td>
            </tr>
          }
        }
      </tbody>
    </table>
  </div>
</div>
